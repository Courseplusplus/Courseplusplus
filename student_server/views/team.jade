//
   Created by peter on 7/9/16.

extends layout
block content
    div(class="panel panel-default")
        div(div class="panel-heading")
            | 队伍详情
            .cus-add(data-toggle='modal', data-target='#myModal')
                i(class="icon-plus" data-toggle="tooltip" data-placement="top" title="新建队伍" )
        .panel-body
            | 队名: #{team.team_name}
        .panel-body
            | 所属课程: #{course.course_name}
        .panel-body
            | 队长: #{leader.name}
        ul(class="list-group")
            each member in team_members
                li(class="list-group-item")
                    if member.accepted == "Not Decided"
                        span(class="label label-default label-pill pull-xs-right label-line-center" style="") 待审
                        span(class="label label-default label-pill pull-xs-right cus-btn cus-btn-disagree" onClick="Check(#{member.student_id},'DENIED')") 拒绝
                        span(class="label label-default label-pill pull-xs-right cus-btn cus-btn-agree" onClick="Check(#{member.student_id},'ACCEPTED')") 通过
                    else if member.accepted == "Accepted"
                        span(class="label label-default label-pill pull-xs-right" style="background-color:green") 通过
                        span(class="label label-default label-pill pull-xs-right cus-btn cus-btn-disagree" onClick="Check(#{member.student_id},'DENIED')") 拒绝
                    else if member.accepted == 'Denied'
                        span(class="label label-default label-pill pull-xs-right" style="background-color:red") 拒绝
                        span(class="label label-default label-pill pull-xs-right cus-btn cus-btn-agree" onClick="Check(#{member.student_id},'ACCEPTED')") 通过

                    div(onclick="location.href='#'") #{member.name}
    script(type='text/javascript').
        var Check = function (student_id, accepted) {
            $.post("/course/#{course.course_id}/team/#{team.team_id}/student/"+student_id,{
                accepted: accepted
            }, function (data) {
                if(data.msg=="success"){
                    console.log("success");
                    location.reload();
                }
                else{
                    alert(data.msg);
                }
            })
        };