//
   Created by peter on 7/11/16.

doctype html
html
    head
        link(rel='stylesheet', href='/bootstrap/css/bootstrap.min.css')
        link(rel='stylesheet', href='/css/index.css')
        title Socket.IO chat
        style.
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font: 13px Helvetica, Arial;
            }

            form {
                background: #000;
                padding: 3px;
                position: fixed;
                bottom: 0;
                width: 100%;
            }

            form input {
                border: 0;
                padding: 10px;
                width: 90%;
                margin-right: .5%;
            }

            form button {
                width: 9%;
                background: rgb(130, 224, 255);
                border: none;
                padding: 10px;
            }

            #messages {
                list-style-type: none;
                margin: 0;
                padding: 0;
            }

            #messages div {
                padding: 5px 10px;
            }

    body
    ul#messages
        form(action='')
            input#m(autocomplete='off')
            button Send
        script(src='/js/socket.io-1.2.0.js')
        script(src='/js/jquery-1.11.1.js')
        script.
            var socket = io("10.138.205.189:3003");
            $('form').submit(function () {
                var value = $('#m').val();
                console.log("#{student.name}");
                console.log(value);
                socket.emit('chat message', {
                    value: value,
                    name: "#{student.name}"
                });
                $('#m').val('');
                return false;
            });
            socket.on('chat message', function (msg) {
                if (msg.name == "#{student.name}") {
                    $('#messages').append($('<div class="col-md-3 col-md-offset-9 my-chat">').text(msg.name + " " + msg.value));
                }
                else {
                    $('#messages').append($('<div class="col-md-3>').text(msg.name + " " + msg.value));
                }
            });
